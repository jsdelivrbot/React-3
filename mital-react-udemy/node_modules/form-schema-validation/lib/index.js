!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var i in r)("object"==typeof exports?exports:e)[i]=r[i]}}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var a=r[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pick=function(e,t){var r={};return t.forEach(function(t){r[t]=e[t]}),r},t.difference=function(e,t){var r=[];return e.forEach(function(e){t.indexOf(e)<0&&r.push(e)}),r}},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t){i(this,e),this.types=t}return a(e,[{key:"getTypes",value:function(){return this.types||[]}},{key:"parseValue",value:function(e){var t={};return this.getTypes().forEach(function(r,i){t["type"+i]=e}),t}},{key:"getSchema",value:function(){var e={};return this.getTypes().forEach(function(t,r){e["type"+r]={type:t,required:!0}}),e}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=r(0),u=r(1),l=i(u),f={notDefinedKey:function(e){return"Key '"+e+"' is not defined in schema"},modelIsUndefined:function(){return"Validated model is undefined"},validateRequired:function(e){return"Field '"+e+"' is required"},validateString:function(e){return"Field '"+e+"' is not a String"},validateNumber:function(e){return"Field '"+e+"' is not a Number"},validateObject:function(e){return"Field '"+e+"' is not a Object"},validateArray:function(e){return"Field '"+e+"' is not a Array"},validateBoolean:function(e){return"Field '"+e+"' is not a Boolean"},validateDate:function(e){return"Field '"+e+"' is not a Date"}},d=function(){function e(t,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];a(this,e),this.schema=t,this.errors={},this.promises=[],this.messages=r||f,this.validateKeys=i,this.validateTypeString=this.validateTypeString.bind(this),this.validateTypeNumber=this.validateTypeNumber.bind(this),this.validateTypeObject=this.validateTypeObject.bind(this),this.validateTypeArray=this.validateTypeArray.bind(this),this.validateTypeBoolean=this.validateTypeBoolean.bind(this),this.validateTypeDate=this.validateTypeDate.bind(this),this.validateTypeSchema=this.validateTypeSchema.bind(this),this.typesValidators={String:this.validateTypeString,Number:this.validateTypeNumber,Object:this.validateTypeObject,Array:this.validateTypeArray,Boolean:this.validateTypeBoolean,Date:this.validateTypeDate}}return o(e,[{key:"getDefaultValueForModel",value:function(e,t){return t?[e]:e}},{key:"getDefaultValues",value:function(){var t=this,r=Object.keys(this.schema),i={};return r.forEach(function(r){var a=t.getField(r),n=Array.isArray(a.type),o=n?a.type[0]:a.type;return a.defaultValue?void(i[r]=t.getDefaultValueForModel(a.defaultValue,n)):a.options?void(i[r]=t.getDefaultValueForModel(a.options[0].label?a.options[0].value:a.options[0],n)):o instanceof e?void(i[r]=t.getDefaultValueForModel(o.getDefaultValues(),n)):"Number"===o.name?void(i[r]=t.getDefaultValueForModel(NaN,n)):"Boolean"===o.name?void(i[r]=t.getDefaultValueForModel(!1,n)):"Object"===o.name?void(i[r]=t.getDefaultValueForModel({},n)):void(i[r]=t.getDefaultValueForModel("",n))}),i}},{key:"getField",value:function(e){return this.schema[e]}},{key:"getFields",value:function(){return this.schema}},{key:"validate",value:function(e){var t=this;return this.errors={},this.promises=[],this.checkModel(e)&&(this.checkKeysDiff(e),this.checkTypesAndValidators(e)),this.promises.length>0?new Promise(function(e){Promise.all(t.promises).then(e(t.errors))}):this.errors}},{key:"setError",value:function(e,t,r){return this.errors[e]||(this.errors[e]=[]),r>-1?void(this.errors[e][r]=t):void this.errors[e].push(t)}},{key:"checkModel",value:function(e){return!!e||(this.setError("model",this.messages.modelIsUndefined()),!1)}},{key:"checkKeysDiff",value:function(e){var t=this;if(!this.validateKeys)return!0;var r=Object.keys(e),i=Object.keys(this.schema),a=(0,s.difference)(r,i);a.length>0&&a.forEach(function(e){t.setError(e,t.messages.notDefinedKey(e))})}},{key:"checkTypesAndValidators",value:function(e){var t=this,r=Object.keys(this.schema),i=(0,s.pick)(e,r);r.forEach(function(e){var r=i[e],a=t.schema[e],n=Array.isArray(a.type),o=n?a.type[0]:a.type;n&&t.validateType(Array,r)?r.forEach(function(r,i){t.validateType(o,r,e,i)}):t.validateType(o,r,e),t.validateRequired(a,r,e),t.validateCustomValidators({validators:a.validators,value:r,fieldSchema:a,validatedObject:i,key:e})})}},{key:"validateCustomValidators",value:function(e){var t=this,r=e.validators,i=e.value,a=e.fieldSchema,n=e.validatedObject,o=e.key;r&&r.forEach(function(e){var r=e.validator,s=e.errorMessage,u=r(i,a,n);return u instanceof Promise?void t.promises.push(u.then(function(e){e||t.setError(o,s)})):void(u||t.setError(o,s))})}},{key:"validateRequired",value:function(e,t,r){!e.required||t&&0!==t.length||this.setError(r,this.messages.validateRequired(r))}},{key:"validateType",value:function(t,r,i,a){if("function"==typeof this.typesValidators[t.name])return this.typesValidators[t.name](r,i,t,a);if(t instanceof e)return this.validateTypeSchema(r,i,t,a);if(t instanceof l.default)return this.validateOneOfTypes(r,i,t,a);throw new Error("Unrecognized type "+t.name)}},{key:"validateTypeString",value:function(e,t,r){return"string"==typeof e||(this.setError(t,this.messages.validateString(t),r),!1)}},{key:"validateTypeNumber",value:function(e,t,r){return"number"==typeof e||(this.setError(t,this.messages.validateNumber(t),r),!1)}},{key:"validateTypeObject",value:function(e,t,r){return"object"===("undefined"==typeof e?"undefined":n(e))&&!Array.isArray(e)||(this.setError(t,this.messages.validateObject(t),r),!1)}},{key:"validateTypeArray",value:function(e,t,r){return!!Array.isArray(e)||(this.setError(t,this.messages.validateArray(t),r),!1)}},{key:"validateTypeBoolean",value:function(e,t,r){return"boolean"==typeof e||(this.setError(t,this.messages.validateBoolean(t),r),!1)}},{key:"validateTypeDate",value:function(e,t,r){return e instanceof Date||(this.setError(t,this.messages.validateDate(t),r),!1)}},{key:"validateTypeSchema",value:function(e,t,r,i){var a=r.validate(e),n=Object.keys(a);return 0===n.length||(this.setError(t,a,i),!1)}},{key:"validateOneOfTypes",value:function(t,r,i,a){var n=new e(i.getSchema()),o=n.validate(i.parseValue(t)),s=Object.keys(o);return s.length<i.getTypes().length||(this.setError(r,o,a),!1)}}],[{key:"oneOfTypes",value:function(e){return new l.default(e)}}]),e}();t.default=d}])});